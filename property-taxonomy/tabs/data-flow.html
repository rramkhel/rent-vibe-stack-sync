<!-- Tab 4: Data Flow -->
<h2 class="section-title">Architecture Diagram</h2>
<p class="section-subtitle">How data flows through the classification system.</p>

<div class="card">
    <div class="card-body" style="text-align: center;">
        <!-- ASCII-style architecture diagram -->
        <pre style="font-family: var(--font-mono); font-size: 12px; line-height: 1.8; text-align: left; display: inline-block; background: var(--gray-900); color: var(--gray-100); padding: var(--space-6); border-radius: var(--radius-lg); overflow-x: auto;">
┌─────────────────────────────────────────────────────────────────┐
│                      EXTERNAL SOURCES                           │
│  ┌──────────┐  ┌──────────┐  ┌──────────┐  ┌──────────┐        │
│  │  BSTK    │  │ RentSync │  │   API    │  │  Import  │        │
│  │  Input   │  │  Input   │  │  Input   │  │  Files   │        │
│  └────┬─────┘  └────┬─────┘  └────┬─────┘  └────┬─────┘        │
└───────┼─────────────┼─────────────┼─────────────┼───────────────┘
        │             │             │             │
        └──────────┬──┴──────┬──────┴──────┬──────┘
                   │         │             │
                   ▼         ▼             ▼
        ┌──────────────────────────────────────────┐
        │         INGEST / NORMALIZE                │
        │  • Validate input                         │
        │  • Map to canonical dimensions            │
        │  • Infer missing values                   │
        └────────────────────┬─────────────────────┘
                             │
                             ▼
        ┌──────────────────────────────────────────┐
        │       CANONICAL DATA STORE                │
        │  ┌────────────────────────────────────┐  │
        │  │ sector: Residential                │  │
        │  │ structureType: House               │  │
        │  │ structureSubtype: Detached         │  │
        │  │ unitType: Basement                 │  │
        │  │ listingType: Rent                  │  │
        │  │ purpose: Conventional              │  │
        │  └────────────────────────────────────┘  │
        │           "The Bible"                    │
        └────────────────────┬─────────────────────┘
                             │
                             ▼
        ┌──────────────────────────────────────────┐
        │         PLATFORM MAPPING LAYER            │
        │  • Per-platform translation tables        │
        │  • Visibility rules                       │
        │  • Display formatting                     │
        └────────────────────┬─────────────────────┘
                             │
        ┌────────┬───────────┼───────────┬─────────┐
        │        │           │           │         │
        ▼        ▼           ▼           ▼         ▼
┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐
│Rentals  │ │  BSTK   │ │RentSync │ │Spacelist│ │ Future  │
│   .ca   │ │         │ │         │ │         │ │Platforms│
└─────────┘ └─────────┘ └─────────┘ └─────────┘ └─────────┘
        </pre>
    </div>
</div>

<h2 class="section-title" style="margin-top: var(--space-8);">Listing Lifecycle</h2>

<div class="grid-3">
    <div class="card">
        <div class="card-header">
            <span class="badge badge-green">1</span>
        </div>
        <div class="card-body">
            <h4 class="card-title">Ingest</h4>
            <p class="text-muted text-small">Data arrives from various sources. Validated and normalized to canonical schema.</p>
        </div>
    </div>

    <div class="card">
        <div class="card-header">
            <span class="badge badge-purple">2</span>
        </div>
        <div class="card-body">
            <h4 class="card-title">Store</h4>
            <p class="text-muted text-small">Canonical representation persisted. Full granularity preserved. "The Bible."</p>
        </div>
    </div>

    <div class="card">
        <div class="card-header">
            <span class="badge badge-teal">3</span>
        </div>
        <div class="card-body">
            <h4 class="card-title">Display</h4>
            <p class="text-muted text-small">Per-platform mapping applied. Simplified for consumers, full for enterprise.</p>
        </div>
    </div>
</div>

<h2 class="section-title" style="margin-top: var(--space-8);">Example Flow</h2>

<div class="card">
    <div class="card-body">
        <pre style="font-family: var(--font-mono); font-size: 12px; line-height: 1.6; margin: 0; background: var(--gray-50); padding: var(--space-4); border-radius: var(--radius-md);"><span style="color: var(--gray-400);">// 1. BSTK sends simplified input</span>
{
  <span style="color: var(--teal);">"property_type"</span>: <span style="color: var(--dim-listing);">"House"</span>,
  <span style="color: var(--teal);">"unit_type"</span>: <span style="color: var(--dim-listing);">"Basement"</span>
}

<span style="color: var(--gray-400);">// 2. Ingest layer infers and normalizes</span>
{
  <span style="color: var(--teal);">"sector"</span>: <span style="color: var(--dim-listing);">"Residential"</span>,       <span style="color: var(--gray-400);">// inferred from House</span>
  <span style="color: var(--teal);">"structureType"</span>: <span style="color: var(--dim-listing);">"House"</span>,
  <span style="color: var(--teal);">"structureSubtype"</span>: <span style="color: var(--dim-listing);">"Unknown"</span>,  <span style="color: var(--gray-400);">// not provided</span>
  <span style="color: var(--teal);">"unitType"</span>: <span style="color: var(--dim-listing);">"Basement"</span>,
  <span style="color: var(--teal);">"listingType"</span>: <span style="color: var(--dim-listing);">"Rent"</span>,        <span style="color: var(--gray-400);">// platform default</span>
  <span style="color: var(--teal);">"purpose"</span>: <span style="color: var(--dim-listing);">"Conventional"</span>      <span style="color: var(--gray-400);">// default</span>
}

<span style="color: var(--gray-400);">// 3. Display on Rentals.ca</span>
<span style="color: var(--dim-listing);">"House · Basement"</span></pre>
    </div>
</div>
