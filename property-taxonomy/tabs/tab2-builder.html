<!-- Tab 2: Interactive Listing Builder -->
<section class="section">
    <h2 class="section-title">Interactive Listing Builder</h2>
    <p class="section-subtitle">Build a listing by selecting values — see how data flows through the system.</p>

    <div class="builder-layout">
        <!-- Left Side: Inputs -->
        <div class="builder-sidebar">
            <div class="card">
                <div class="card-header">
                    <div class="card-title">Build Your Listing</div>
                </div>
                <div class="card-body">
                    <!-- Path Selector -->
                    <div class="form-group">
                        <label class="form-label">Choose Your Path</label>
                        <div class="path-toggle">
                            <button type="button" class="btn builder-path-btn active" id="path-unit-first">Unit-First</button>
                            <button type="button" class="btn builder-path-btn" id="path-structure-first">Structure-First</button>
                        </div>
                    </div>

                    <hr class="form-divider">

                    <!-- Unit-First Inputs -->
                    <div id="unit-first-inputs">
                        <div class="form-group">
                            <label class="form-label">Unit Type <span class="required">*</span></label>
                            <select id="uf-unit-type" class="form-select">
                                <option value="">Select unit type...</option>
                                <optgroup label="Self-sufficient (no building needed)">
                                    <option value="apartment">Apartment</option>
                                    <option value="basement">Basement</option>
                                    <option value="room_private">Room (Private)</option>
                                    <option value="room_shared">Room (Shared)</option>
                                    <option value="office">Office Space</option>
                                    <option value="parking">Parking</option>
                                </optgroup>
                            </select>
                        </div>

                        <div class="form-group" id="uf-building-toggle-group" style="display: none;">
                            <label class="checkbox-label">
                                <input type="checkbox" id="uf-know-building">
                                <span>Know the building type? (optional)</span>
                            </label>
                        </div>

                        <div id="uf-building-details" style="display: none;">
                            <div class="form-group">
                                <label class="form-label">Property Type</label>
                                <select id="uf-property-type" class="form-select">
                                    <option value="">Select property type...</option>
                                </select>
                            </div>
                            <div class="form-group" id="uf-subtype-group" style="display: none;">
                                <label class="form-label">Subtype</label>
                                <select id="uf-subtype" class="form-select">
                                    <option value="">Select subtype...</option>
                                </select>
                            </div>
                            <div class="form-group" id="uf-variant-group" style="display: none;">
                                <label class="form-label">Variant</label>
                                <select id="uf-variant" class="form-select">
                                    <option value="">None</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Structure-First Inputs -->
                    <div id="structure-first-inputs" style="display: none;">
                        <div class="form-group">
                            <label class="form-label">Sector <span class="required">*</span></label>
                            <select id="sf-sector" class="form-select">
                                <option value="">Select sector...</option>
                                <option value="residential">Residential</option>
                                <option value="commercial">Commercial</option>
                                <option value="recreation">Recreation</option>
                                <option value="other">Other</option>
                            </select>
                        </div>
                        <div class="form-group" id="sf-property-type-group" style="display: none;">
                            <label class="form-label">Property Type <span class="required">*</span></label>
                            <select id="sf-property-type" class="form-select">
                                <option value="">Select property type...</option>
                            </select>
                        </div>
                        <div class="form-group" id="sf-subtype-group" style="display: none;">
                            <label class="form-label">Subtype</label>
                            <select id="sf-subtype" class="form-select">
                                <option value="">Select subtype...</option>
                            </select>
                        </div>
                        <div class="form-group" id="sf-variant-group" style="display: none;">
                            <label class="form-label">Variant</label>
                            <select id="sf-variant" class="form-select">
                                <option value="">None</option>
                            </select>
                        </div>
                        <div class="form-group" id="sf-unit-type-group" style="display: none;">
                            <label class="form-label">Unit Type <span class="required">*</span></label>
                            <select id="sf-unit-type" class="form-select">
                                <option value="">Select unit type...</option>
                            </select>
                        </div>
                    </div>

                    <hr class="form-divider">

                    <!-- Transaction -->
                    <div class="form-group">
                        <label class="form-label">Transaction <span class="required">*</span></label>
                        <select id="transaction" class="form-select">
                            <option value="">Select transaction...</option>
                            <option value="rent">Rent</option>
                            <option value="sale">Sale</option>
                            <option value="lease">Lease</option>
                        </select>
                    </div>

                    <hr class="form-divider">
                    <div class="form-divider-label">Metadata</div>

                    <!-- Metadata -->
                    <div class="form-group">
                        <label class="form-label">Purpose</label>
                        <select id="purpose" class="form-select">
                            <option value="standard">Standard</option>
                            <option value="student">Student</option>
                            <option value="senior">Senior</option>
                            <option value="military_veteran">Military/Veteran</option>
                            <option value="corporate">Corporate</option>
                            <option value="vacation">Vacation</option>
                            <option value="short_term">Short-Term</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Ownership</label>
                        <select id="ownership" class="form-select">
                            <option value="rental">Rental</option>
                            <option value="freehold">Freehold</option>
                            <option value="condo">Condo</option>
                            <option value="coop">Co-op</option>
                            <option value="leasehold">Leasehold</option>
                            <option value="lease_to_own">Lease-to-Own</option>
                            <option value="rent_to_own">Rent-to-Own</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="community-toggle">
                            <span>Part of a Community</span>
                        </label>
                    </div>

                    <div class="form-group" id="community-name-group" style="display: none;">
                        <label class="form-label">Community Name</label>
                        <input type="text" id="community-name" class="form-input" placeholder="e.g., Maple Heights">
                    </div>

                    <!-- Amenities Section -->
                    <hr class="form-divider">

                    <div class="amenities-header">
                        <div class="form-divider-label" style="margin-bottom: 0;">Amenities & Attributes</div>
                        <div class="amenities-controls">
                            <button type="button" class="btn-xs" id="expand-all-amenities">Expand All</button>
                            <button type="button" class="btn-xs" id="collapse-all-amenities">Collapse All</button>
                        </div>
                        <span class="amenities-counter empty" id="amenities-counter">0 selected</span>
                    </div>

                    <div class="amenities-context-notice" id="amenities-context-notice">
                        <span class="text-muted">Select a property type above to see applicable amenities.</span>
                    </div>

                    <!-- Structured Sections: Parking, Pets, Utilities -->
                    <div class="amenity-section structured" id="section-parking">
                        <button type="button" class="amenity-section-header" data-section="parking">
                            <span class="section-name">Parking</span>
                            <span class="section-count" id="parking-count"></span>
                            <span class="section-chevron">&#9656;</span>
                        </button>
                        <div class="amenity-section-body" id="body-parking">
                            <div class="amenity-enum">
                                <label class="form-label-sm">Parking Availability</label>
                                <select class="form-select-sm" id="parking-availability">
                                    <option value="">Not specified</option>
                                    <option value="Yes - included in rent">Yes - included in rent</option>
                                    <option value="Yes - available on property">Yes - available on property</option>
                                    <option value="No parking available">No parking available</option>
                                </select>
                            </div>
                            <div class="parking-types hidden" id="parking-types">
                                <label class="form-label-sm">Parking Types</label>
                                <div class="checkbox-grid" id="parking-types-grid"></div>
                            </div>
                            <div class="parking-per-unit hidden" id="parking-per-unit">
                                <div class="input-row">
                                    <label class="form-label-sm" style="flex:1;">Spots Included</label>
                                    <input type="number" class="form-input-sm" id="parking-spots" style="width:80px;" min="0" placeholder="0">
                                </div>
                                <div class="input-row">
                                    <label class="form-label-sm" style="flex:1;">Extra Cost/Month</label>
                                    <span class="input-prefix">$</span>
                                    <input type="number" class="form-input-sm" id="parking-cost" style="width:80px;" min="0" placeholder="0">
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="amenity-section structured" id="section-pets">
                        <button type="button" class="amenity-section-header" data-section="pets">
                            <span class="section-name">Pet Policy</span>
                            <span class="section-count" id="pets-count"></span>
                            <span class="section-chevron">&#9656;</span>
                        </button>
                        <div class="amenity-section-body" id="body-pets">
                            <div class="amenity-enum">
                                <label class="form-label-sm">Pet Policy</label>
                                <select class="form-select-sm" id="pet-policy">
                                    <option value="">Not specified</option>
                                    <option value="Yes - pets welcome">Yes - pets welcome</option>
                                    <option value="Yes - case by case">Yes - case by case</option>
                                    <option value="No pets allowed">No pets allowed</option>
                                </select>
                            </div>
                            <div class="pet-types hidden" id="pet-types">
                                <label class="form-label-sm">Pet Types Allowed</label>
                                <div class="checkbox-grid" id="pet-types-grid"></div>
                            </div>
                            <div class="pet-restrictions hidden" id="pet-restrictions">
                                <label class="form-label-sm">Dog Size Restriction</label>
                                <select class="form-select-sm" id="dog-size">
                                    <option value="">No restriction</option>
                                    <option value="Extra small only (<10 lbs)">Extra small only (&lt;10 lbs)</option>
                                    <option value="Small (up to 25 lbs)">Small (up to 25 lbs)</option>
                                    <option value="Medium (up to 50 lbs)">Medium (up to 50 lbs)</option>
                                    <option value="Large (up to 75 lbs)">Large (up to 75 lbs)</option>
                                    <option value="Extra large (75+ lbs)">Extra large (75+ lbs)</option>
                                </select>
                            </div>
                            <div class="pet-fees hidden" id="pet-fees">
                                <div class="input-row">
                                    <label class="form-label-sm" style="flex:1;">Pet Deposit</label>
                                    <span class="input-prefix">$</span>
                                    <input type="number" class="form-input-sm" id="pet-deposit" style="width:80px;" min="0" placeholder="0">
                                </div>
                                <div class="input-row">
                                    <label class="form-label-sm" style="flex:1;">Monthly Pet Fee</label>
                                    <span class="input-prefix">$</span>
                                    <input type="number" class="form-input-sm" id="pet-monthly" style="width:80px;" min="0" placeholder="0">
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="amenity-section structured" id="section-utilities">
                        <button type="button" class="amenity-section-header" data-section="utilities">
                            <span class="section-name">Utilities</span>
                            <span class="section-count" id="utilities-count"></span>
                            <span class="section-chevron">&#9656;</span>
                        </button>
                        <div class="amenity-section-body" id="body-utilities">
                            <div class="utility-grid" id="utilities-grid"></div>
                        </div>
                    </div>

                    <!-- Property Amenities -->
                    <div class="amenity-group-divider">
                        <span>Property Amenities</span>
                    </div>
                    <div id="property-amenities-container"></div>

                    <!-- Unit Amenities -->
                    <div class="amenity-group-divider">
                        <span>Unit Amenities</span>
                    </div>
                    <div id="unit-amenities-container"></div>
                </div>
            </div>
        </div>

        <!-- Right Side: Live Output -->
        <div class="builder-output">
            <!-- Section A: The Collapsed Sentence -->
            <div class="card mb-6">
                <div class="card-header">
                    <div class="card-title">The Listing</div>
                </div>
                <div class="card-body">
                    <div class="sentence-box" id="output-sentence">
                        <div class="sentence-text" id="sentence-text">
                            <span class="text-muted">Select a unit type and transaction to see your listing...</span>
                        </div>
                        <div class="sentence-meta" id="sentence-meta"></div>
                    </div>
                </div>
            </div>

            <!-- Section B: Canonical Storage -->
            <div class="card mb-6">
                <div class="card-header">
                    <div>
                        <div class="card-title">Canonical Storage</div>
                        <div class="card-subtitle">How the system stores this listing</div>
                    </div>
                    <div class="view-toggle">
                        <button type="button" class="view-toggle-btn active" data-view="visual">Visual</button>
                        <button type="button" class="view-toggle-btn" data-view="json">JSON</button>
                    </div>
                </div>
                <div class="card-body">
                    <div id="canonical-visual" class="canonical-view">
                        <div class="b-row"><span class="badge badge-purple">Sector</span> <span class="b-val null" id="cv-sector">—</span></div>
                        <div class="b-row"><span class="badge badge-amber">Property Type</span> <span class="b-val null" id="cv-property-type">null</span></div>
                        <div class="b-row"><span class="badge badge-orange">Subtype</span> <span class="b-val null" id="cv-subtype">null</span></div>
                        <div class="b-row"><span class="badge badge-cyan">Variant</span> <span class="b-val null" id="cv-variant">null</span></div>
                        <div class="b-row"><span class="badge badge-teal">Unit Type</span> <span class="b-val null" id="cv-unit-type">—</span></div>
                        <div class="b-row"><span class="badge badge-green">Transaction</span> <span class="b-val null" id="cv-transaction">—</span></div>
                        <hr class="meta-divider">
                        <div class="b-row"><span class="badge badge-gray">Purpose</span> <span class="b-val" id="cv-purpose">standard</span></div>
                        <div class="b-row"><span class="badge badge-gray">Ownership</span> <span class="b-val" id="cv-ownership">rental</span></div>
                        <div class="b-row"><span class="badge badge-gray">Community</span> <span class="b-val null" id="cv-community">null</span></div>
                    </div>
                    <div id="canonical-json" class="canonical-view json-view" style="display: none;">
                        <pre id="json-output">{
  "sector": null,
  "property_type": null,
  "subtype": null,
  "variant": null,
  "unit_type": null,
  "transaction": null,
  "metadata": {
    "purpose": "standard",
    "ownership": "rental",
    "community": null
  }
}</pre>
                    </div>
                </div>
            </div>

            <!-- Section C: Platform Display -->
            <div class="card">
                <div class="card-header">
                    <div>
                        <div class="card-title">Platform Display</div>
                        <div class="card-subtitle">How this listing appears on each platform</div>
                    </div>
                </div>
                <div class="card-body">
                    <div class="platform-grid">
                        <div class="platform-card">
                            <div class="platform-card-header enterprise">BSTK / RentSync</div>
                            <div class="platform-card-body">
                                <div class="platform-display" id="platform-bstk">
                                    <span class="text-muted">Select a listing type to see output</span>
                                </div>
                            </div>
                        </div>
                        <div class="platform-card">
                            <div class="platform-card-header ils">Rentals.ca / RentFaster</div>
                            <div class="platform-card-body">
                                <div class="platform-display" id="platform-ils">
                                    <span class="text-muted">Select a listing type to see output</span>
                                </div>
                            </div>
                        </div>
                        <div class="platform-card">
                            <div class="platform-card-header commercial">Spacelist</div>
                            <div class="platform-card-body">
                                <div class="platform-display" id="platform-spacelist">
                                    <span class="text-muted">Select a listing type to see output</span>
                                </div>
                            </div>
                        </div>
                        <div class="platform-card">
                            <div class="platform-card-header mls">MLS / Roomies</div>
                            <div class="platform-card-body">
                                <div class="platform-display" id="platform-mls">
                                    <span class="text-muted">Select a listing type to see output</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
