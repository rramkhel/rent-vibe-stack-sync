<div class="page">
    <span class="doc-label">Data Flow</span>
    <h2 class="page-title">Inbound & Outbound Syndication</h2>
    <p class="subtitle">Data flows in from PMS systems and out to listing platforms. The canonical model is the translation layer.</p>

    <!-- Flow Diagram -->
    <div class="flow-container">
        <div class="flow-column">
            <h5>Inbound Sources</h5>
            <div class="flow-item inbound">Yardi (PMS feed)</div>
            <div class="flow-item inbound">RealPage (PMS feed)</div>
            <div class="flow-item inbound">AppFolio (PMS feed)</div>
            <div class="flow-item inbound">Direct Entry (Sarah)</div>
            <div class="flow-item inbound">Acquisition (Migration)</div>
        </div>

        <div class="flow-arrow">â†’</div>

        <div class="flow-column" style="background: var(--canonical-light); border-color: var(--canonical);">
            <h5 style="color: var(--canonical);">Canonical Storage</h5>
            <div class="flow-item canonical" style="text-align: center; font-weight: 600;">
                The Bible<br>
                <span style="font-weight: 400; font-size: 0.85em;">(single source of truth)</span>
            </div>
            <p style="font-size: 0.85em; color: var(--warm-gray); text-align: center; margin: 10px 0 0 0;">All data normalized to canonical dimensions</p>
        </div>

        <div class="flow-arrow">â†’</div>

        <div class="flow-column">
            <h5>Outbound Destinations</h5>
            <div class="flow-item outbound">Rentals.ca (simplified)</div>
            <div class="flow-item outbound">RentFaster (ILS)</div>
            <div class="flow-item outbound">Zumper / Zillow (3rd party)</div>
            <div class="flow-item outbound">Spacelist (commercial)</div>
            <div class="flow-item outbound">Kijiji (classifieds)</div>
        </div>
    </div>

    <h3>Inbound Challenge: External Systems Don't Use Our Taxonomy</h3>

    <div class="table-wrapper">
        <table class="compare-table">
            <thead>
                <tr>
                    <th>Source</th>
                    <th>Their Data</th>
                    <th>Our Challenge</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>Yardi</strong></td>
                    <td><code>PropertyType: "Apartment"</code></td>
                    <td>Which kind? High-rise? Low-rise? Garden?</td>
                </tr>
                <tr>
                    <td><strong>RealPage</strong></td>
                    <td><code>UnitType: "1BR/1BA"</code></td>
                    <td>That's beds/baths, not our UnitType dimension</td>
                </tr>
                <tr>
                    <td><strong>AppFolio</strong></td>
                    <td><code>Category: "Residential"</code></td>
                    <td>Way too broad â€” we need Structure</td>
                </tr>
                <tr>
                    <td><strong>Acquisition</strong></td>
                    <td>Whatever they had</td>
                    <td>Full migration/mapping project</td>
                </tr>
            </tbody>
        </table>
    </div>

    <h3>Inbound Mapping Strategies</h3>

    <div class="card-grid">
        <div class="card">
            <div class="card-icon" style="background: var(--rentals-light);">ðŸŽ¯</div>
            <h5>Option A: Best-Effort + Review</h5>
            <p>Map what we can, flag unknowns for human review. "Is this a High Rise, Mid Rise, or Low Rise?"</p>
        </div>
        <div class="card">
            <div class="card-icon" style="background: var(--bstk-light);">ðŸ“‹</div>
            <h5>Option B: Source-Specific Tables</h5>
            <p>Build translation tables per PMS. Yardi "SFR" â†’ our "House". Explicit mappings.</p>
        </div>
        <div class="card">
            <div class="card-icon" style="background: var(--canonical-light);">ðŸ¤–</div>
            <h5>Option C: AI Normalization</h5>
            <p>For messy feeds: "Garden-style apt, ground floor" â†’ AI parses structure, subtype, unit type.</p>
        </div>
    </div>

    <h4>Example: Yardi â†’ Canonical Mapping Table</h4>

    <div class="table-wrapper">
        <table class="dimension-table" style="font-size: 0.9em;">
            <thead>
                <tr>
                    <th>Yardi Field</th>
                    <th>Yardi Value</th>
                    <th>â†’</th>
                    <th>Canonical Field</th>
                    <th>Canonical Value</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>PropertyType</td>
                    <td><code>Apartment</code></td>
                    <td>â†’</td>
                    <td>StructureType</td>
                    <td><code>Apartment Building</code></td>
                </tr>
                <tr>
                    <td>PropertyType</td>
                    <td><code>SFR</code></td>
                    <td>â†’</td>
                    <td>StructureType</td>
                    <td><code>House</code></td>
                </tr>
                <tr>
                    <td>PropertyType</td>
                    <td><code>Condo</code></td>
                    <td>â†’</td>
                    <td>Ownership</td>
                    <td><code>Condo</code></td>
                </tr>
                <tr>
                    <td>UnitType</td>
                    <td><code>Studio</code></td>
                    <td>â†’</td>
                    <td>UnitType</td>
                    <td><code>Studio</code></td>
                </tr>
            </tbody>
        </table>
    </div>

    <h3>Outbound: Platform-Specific Display</h3>

    <p>Each destination needs its own mapping table â€” different platforms have different required fields and enum values.</p>

    <div class="code-block">
<pre><span class="comment">// Canonical â†’ Rentals.ca mapping</span>
{
  <span class="key">"A-Frame"</span>: <span class="string">"House"</span>,       <span class="comment">// Simplified for consumer search</span>
  <span class="key">"Yurt"</span>: <span class="string">"House"</span>,
  <span class="key">"Cabin"</span>: <span class="string">"House"</span>,
  <span class="key">"High Rise"</span>: <span class="string">"Apartment"</span>,
  <span class="key">"Mid Rise"</span>: <span class="string">"Apartment"</span>
}

<span class="comment">// Canonical â†’ WoodCabins.ca mapping</span>
{
  <span class="key">"A-Frame"</span>: <span class="string">"A-Frame"</span>,     <span class="comment">// First-class category!</span>
  <span class="key">"Yurt"</span>: <span class="string">"Yurt"</span>,
  <span class="key">"Cabin"</span>: <span class="string">"Cabin"</span>,
  <span class="key">"High Rise"</span>: <span class="keyword">null</span>,       <span class="comment">// Hidden - not relevant</span>
  <span class="key">"Townhouse"</span>: <span class="keyword">null</span>        <span class="comment">// Hidden - not relevant</span>
}

<span class="comment">// Canonical â†’ Zillow mapping</span>
{
  <span class="key">"House"</span>: <span class="string">"SINGLE_FAMILY"</span>,  <span class="comment">// Their enum values</span>
  <span class="key">"Townhouse"</span>: <span class="string">"TOWNHOUSE"</span>,
  <span class="key">"Apartment Building"</span>: <span class="string">"APARTMENT"</span>
}</pre>
    </div>

    <div class="callout">
        <div class="callout-icon">ðŸ”‘</div>
        <div class="callout-content">
            <h5>Key Questions to Resolve</h5>
            <p>Who maintains the mapping tables? Product? Engineering? Per-client customization? What's the fallback for unmappable data â€” flag for review, best guess, or reject?</p>
        </div>
    </div>
</div>
